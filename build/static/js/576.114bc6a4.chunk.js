"use strict";(self.webpackChunksocial_crud_app=self.webpackChunksocial_crud_app||[]).push([[576],{2576:function(e,t,n){n.r(t),n.d(t,{default:function(){return T}});var s=n(4165),r=n(5861),a=n(4942),i=n(1413),l=n(885),o=n(3418),c=n(2791),u=n(978),d=n(8720),m=n(8021),x=n(7834),h=n(2596),v=n(1460),f=n(184),p=function(e){var t=e.children,n=e.customClasses,s=void 0===n?"":n,r=e.menuBtnClasses,a=void 0===r?"":r,i=e.menuClasses,l=void 0===i?"":i,o=(e.handleEdit,e.handleDelete),u=void 0===o?function(){}:o;return(0,f.jsx)("div",{className:s,children:(0,f.jsxs)(h.v,{as:"div",className:"relative ".concat(l),children:[(0,f.jsx)("div",{children:(0,f.jsx)(h.v.Button,{className:a,children:t})}),(0,f.jsx)(v.u,{as:c.Fragment,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:(0,f.jsxs)(h.v.Items,{className:"absolute right-0 mt-2 w-[185px] origin-top-right divide-y divide-gray-100 rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none",children:[(0,f.jsx)("div",{className:"px-1 py-1 ",children:(0,f.jsx)(h.v.Item,{children:function(e){var t=e.active;return(0,f.jsx)("button",{type:"button",className:"".concat(t?"bg-sky-600 text-white":"text-gray-900"," group w-full rounded-md px-2 py-2 font-medium text-base capitalize"),onClick:u,children:"delete"})}})}),(0,f.jsx)("div",{className:"px-1 py-1 ",children:(0,f.jsx)(h.v.Item,{children:function(e){var t=e.active;return(0,f.jsx)("button",{type:"button",className:"".concat(t?"bg-sky-600 text-white":"text-gray-900"," group w-full rounded-md px-2 py-2 font-medium text-base capitalize"),children:"help"})}})})]})})]})})},g=n(2298),j=n(9593),b=function(e){var t=e.open,n=e.title,s=void 0===n?"Give a title":n,r=e.children,a=e.customPanelClasses,i=e.headerSection,l=function(){null===t||void 0===t||t.setIsOpen(!1)};return(0,f.jsx)("div",{children:(0,f.jsx)(v.u,{appear:!0,show:null===t||void 0===t?void 0:t.isOpen,as:c.Fragment,children:(0,f.jsxs)(j.V,{as:"div",className:"relative z-10",onClose:l,children:[(0,f.jsx)(v.u.Child,{as:c.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,f.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),(0,f.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,f.jsx)("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:(0,f.jsx)(v.u.Child,{as:c.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,f.jsxs)(j.V.Panel,{className:"w-full transform overflow-hidden p-6 text-center align-middle shadow-xl transition-all ".concat(a),children:[" ",i?(0,f.jsxs)("div",{className:"flex justify-between items-center",children:[(0,f.jsx)(j.V.Title,{as:"h3",className:"text-xl font-medium leading-6 text-gray-900",children:s}),(0,f.jsx)("div",{className:"",children:(0,f.jsx)("button",{type:"button",className:"inline-flex justify-center rounded-md border border-transparent bg-blue-100 px-4 py-2 text-sm font-medium text-blue-900 hover:bg-blue-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 text-right",onClick:l,children:(0,f.jsx)(g.mV,{})})})]}):null,(0,f.jsx)("div",{className:"mt-3",children:r})]})})})})]})})})},y=function(e){var t=e.comments,n=void 0===t?[]:t;return(0,f.jsx)("div",{className:"",children:null===n||void 0===n?void 0:n.map((function(e){return(0,f.jsxs)("div",{className:"flex items-center gap-1 my-2",children:[(0,f.jsx)("div",{className:"",children:(0,f.jsx)(g.m1,{src:"".concat(null===e||void 0===e?void 0:e.userImage),alt:null===e||void 0===e?void 0:e.userName,customClasses:"w-9 h-9"})}),(0,f.jsxs)("div",{className:"flex items-start flex-col flex-1",children:[(0,f.jsx)("div",{children:(0,f.jsx)("div",{className:"",children:(0,f.jsx)(g.ad,{heading:null===e||void 0===e?void 0:e.userName})})}),(0,f.jsxs)("div",{className:"w-full",children:[(0,f.jsx)("div",{className:"py-1 px-2 bg-slate-200 rounded-lg block",children:(0,f.jsx)(g.go,{text:null===e||void 0===e?void 0:e.comment,customClasses:"my-1 text-normal mx-2"})}),(0,f.jsxs)("div",{className:"flex items-center gap-2",children:[(0,f.jsx)("span",{className:"cursor-pointer",children:(0,f.jsx)(g.nf,{customClasses:"w-4 h-4"})}),(0,f.jsx)("span",{className:"",children:(0,f.jsx)(g.Zp,{time:null===e||void 0===e?void 0:e.createdAt})})]})]})]})]},null===e||void 0===e?void 0:e.id)}))})},w=n(763),N=function(e){var t=e.id,n=(0,c.useState)(""),a=(0,l.Z)(n,2),i=a[0],x=a[1],h=(0,m.a)({queryKey:["comments"],queryFn:function(){var e=(0,r.Z)((0,s.Z)().mark((function e(){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.WY.get("/api/comments/".concat(t)).then((function(e){return e.data.data})).catch((function(e){return console.error(e)}));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}),v=h.isLoading,p=h.data,j=(0,o.D)({mutationKey:"mutateComments",mutationFn:function(){var e=(0,r.Z)((0,s.Z)().mark((function e(n){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.WY.post("/api/create-comment/".concat(t),n).then(function(){var e=(0,r.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.E.invalidateQueries(["comments"]);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).finally((function(){return x("")}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),onError:function(e){console.log({err:e}),alert("Mutation unsuccessful!")}}),b=j.mutate,N=j.error,Z=function(){var e=(0,r.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b({comment:i});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,f.jsx)("div",{children:(0,f.jsxs)("div",{className:"",children:[(0,f.jsx)("div",{className:"mb-3",children:(0,f.jsx)(g.nL,{heading:"Comments"})}),(0,w.size)(null===p||void 0===p?void 0:p.comments)>1?(0,f.jsx)("div",{className:"",children:(0,f.jsx)(y,{comments:null===p||void 0===p?void 0:p.comments})}):null,v?"Comment is loading":null,(0,f.jsxs)("div",{className:"",children:[(0,f.jsx)("div",{className:"my-2",children:(0,f.jsx)(g.Kx,{rows:3,customClasses:"block w-full text-sm text-gray-800 bg-white border-2 p-2 resize-none rounded-lg",handleTextarea:function(e){x(e.target.value)},value:i,placeholder:"write your comment"})}),N?(0,f.jsx)("small",{className:"text-red-700",children:N}):null,(0,f.jsx)("div",{className:"",children:(0,f.jsx)(g.T2,{title:"Publish post",customClasses:"focus:ring-blue-20 text-sm font-medium hover:bg-blue-800 disabled:bg-blue-200 disabled:hover:disabled:bg-blue-200 text-white bg-blue-700 ",disabled:(0,w.size)(i)<0,handleMutate:Z})})]})]})})},Z=function(e){var t,n,a,i=e.post,m=(0,x.Z)().auth,h=(0,c.useState)(!1),v=(0,l.Z)(h,2),j=v[0],y=v[1],w=(0,c.useState)(!1),Z=(0,l.Z)(w,2),k=Z[0],C=Z[1],F=(0,c.useState)(!1),P=(0,l.Z)(F,2),I=P[0],S=P[1],T=(0,c.useState)(0),z=(0,l.Z)(T,2),D=(z[0],z[1]),E=(0,c.useState)(!1),B=(0,l.Z)(E,2),_=B[0],K=B[1],W=(0,o.D)({mutationKey:"postDelete",mutationFn:function(e){return d.WY.post("/api/delete/post/".concat(e)).then(function(){var e=(0,r.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.E.invalidateQueries(["posts"]);case 2:return e.next=4,K((function(e){return!e}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log({error:e}),alert("Post delete unsuccessful!")}))},onError:function(e){console.log({err:e}),alert("Post delete unsuccessful!")}}),Y=W.mutate,L=W.isLoading,M=function(){var e=(0,r.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y(null===i||void 0===i?void 0:i._id);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,f.jsxs)("div",{className:"bg-white shadow-lg rounded-lg my-4 ",children:[(0,f.jsxs)("div",{className:"px-4 py-6",children:[(0,f.jsxs)("div",{className:"flex items-center gap-1 mb-3",children:[(0,f.jsx)("div",{className:"",children:(0,f.jsx)(g.m1,{src:i.userImage,alt:"avatar"})}),(0,f.jsxs)("div",{className:"flex items-start justify-between w-full",children:[(0,f.jsxs)("div",{className:"flex items-start flex-col gap-1",children:[(0,f.jsx)("div",{className:"",children:(0,f.jsx)(g.ad,{heading:null===i||void 0===i?void 0:i.userName})}),(0,f.jsx)(g.Zp,{time:i.createdAt})]}),(0,f.jsx)("div",{className:"",children:m&&m.id===(null===i||void 0===i?void 0:i.userId)?(0,f.jsx)("span",{className:"cursor-pointer",tabIndex:0,role:"button",children:(0,f.jsx)(p,{menuClasses:"w-full",handleDelete:function(){return K((function(e){return!e}))},children:(0,f.jsx)(g.wz,{})})}):null})]})]}),(0,f.jsxs)("div",{className:"",children:[(0,f.jsx)(g.go,{text:null===i||void 0===i?void 0:i.text,customClasses:"text-lg font-normal capitalize"}),null!==i&&void 0!==i&&i.imageName?(0,f.jsx)("div",{className:"cursor-pointer",onClick:function(){return y((function(e){return!e}))},children:(0,f.jsx)(g.Ee,{customClasses:"h-[340px] w-[100%] object-cover shadow",src:i.imageName,alt:null!==(t=i.text)&&void 0!==t?t:"Post"})}):null]}),m?(0,f.jsxs)("div",{className:"my-3 flex gap-5 items-center",children:[(0,f.jsx)("div",{className:"flex items-center mr-2 text-gray-700 text-lg cursor-pointer",onClick:function(){return C((function(e){return!e}))},children:k?(0,f.jsx)(g.SX,{}):(0,f.jsx)(g.nf,{})}),(0,f.jsx)("div",{className:"flex items-center mr-2 text-gray-700 text-lg cursor-pointer",onClick:function(){return S((function(e){return!e}))},children:I?(0,f.jsx)(g.DG,{}):(0,f.jsx)(g.k5,{})})]}):null,m?(0,f.jsx)(f.Fragment,{children:I?(0,f.jsx)("div",{className:"border-t-2 border-t-slate-200",children:(0,f.jsx)(N,{id:null===i||void 0===i?void 0:i._id,setTotalComment:D})}):null}):null]}),(0,f.jsx)(b,{open:{isOpen:j,setIsOpen:y},customPanelClasses:"max-w-[80%]",title:null!==(n=null===i||void 0===i?void 0:i.text)&&void 0!==n?n:"",children:(0,f.jsx)(g.Ee,{customClasses:"w-full",src:null===i||void 0===i?void 0:i.imageName,alt:null!==(a=null===i||void 0===i?void 0:i.text)&&void 0!==a?a:"Post"})}),(0,f.jsx)(b,{open:{isOpen:_,setIsOpen:K},customPanelClasses:"max-w-[500px] bg-white rounded-lg",title:"Delete Modal",children:(0,f.jsxs)("div",{className:"py-5",children:[(0,f.jsx)("div",{className:"mb-5",children:(0,f.jsx)(g.nL,{customClasses:"text-2xl",heading:"You want to delete this post?"})}),(0,f.jsxs)("div",{className:"",children:[(0,f.jsx)(g.T2,{customClasses:"justify-center mr-3 w-[100px] focus:ring-red-20 text-sm text-white font-medium hover:bg-red-800 text-white bg-red-700",title:"Delete",handleMutate:M,disabled:L}),(0,f.jsx)(g.PZ,{title:"Cancel",customClasses:"justify-center w-[100px] focus:ring-blue-20 text-sm font-medium bg-blue-700 hover:bg-blue-800 text-white",handleClose:function(){return K((function(e){return!e}))},disabled:L})]})]})})]})},k=function(){var e=(0,m.a)({queryKey:["posts"],queryFn:function(){var e=(0,r.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.WY.get("/api/posts").then((function(e){return e.data.data})).catch((function(e){return console.error(e)}));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}),t=(e.isLoading,e.error,e.data);return(0,f.jsx)("div",{children:function(){var e;return(0,f.jsx)("div",{className:"",children:null===t||void 0===t||null===(e=t.posts)||void 0===e?void 0:e.map((function(e,t){return(0,f.jsx)(Z,{post:e},t)}))})}()})},C=function(e){var t=e.post,n=e.handlePost,s=e.handlePostSubmit,r=e.activeBtn;return(0,f.jsx)("div",{children:(0,f.jsxs)("form",{children:[(0,f.jsx)("div",{className:"flex items-center gap-2 mb-4 w-full bg-gray-50 rounded-lg border border-gray-200 dark:bg-gray-700 dark:border-gray-600",children:(0,f.jsxs)("div",{className:"flex-1 bg-white rounded-b-lg dark:bg-gray-800",children:[(0,f.jsx)("label",{for:"editor",className:"sr-only",children:"Publish post"}),(0,f.jsx)(g.Kx,{name:"text",rows:"6",customClasses:"block w-full text-sm text-gray-800 bg-white border-0 dark:bg-gray-800 focus:ring-0 dark:text-white dark:placeholder-gray-400 p-2 resize-none",placeholder:"Write an post...",value:null===t||void 0===t?void 0:t.text,handleTextarea:function(e){return n(e)}})]})}),(0,f.jsx)(g.T2,{title:"Publish post",customClasses:"inline-flex items-center px-5 py-2.5 text-sm font-medium text-center text-white bg-blue-700 rounded-lg focus:ring-4 focus:ring-blue-20 hover:bg-blue-800 disabled:bg-blue-200 disabled:hover:disabled:bg-blue-200",disabled:!r,handleMutate:s})]})})},F=function(){return(0,f.jsx)("div",{children:(0,f.jsx)("h1",{className:"text-xl font-medium text-center",children:"Section on process"})})},P=n(1087),I=function(e){var t=e.children,n=e.customClasses,s=void 0===n?"":n,r=e.menuBtnClasses,a=void 0===r?"":r,i=e.menuClasses,l=void 0===i?"":i,o=e.handleButton,u=void 0===o?function(){}:o;return(0,f.jsx)("div",{className:s,children:(0,f.jsxs)(h.v,{as:"div",className:"relative ".concat(l),children:[(0,f.jsx)("div",{children:(0,f.jsx)(h.v.Button,{className:a,children:t})}),(0,f.jsx)(v.u,{as:c.Fragment,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:(0,f.jsxs)(h.v.Items,{className:"absolute right-0 mt-2 w-full origin-top-right divide-y divide-gray-100 rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none",children:[(0,f.jsx)("div",{className:"px-1 py-1 ",children:(0,f.jsx)(h.v.Item,{children:function(e){var t=e.active;return(0,f.jsx)(P.rU,{to:"/profile",className:"".concat(t?"bg-sky-600 text-white":"text-gray-900"," group flex w-full items-center rounded-md px-2 py-2 font-medium text-base capitalize"),children:"profile"})}})}),(0,f.jsx)("div",{className:"px-1 py-1 ",children:(0,f.jsx)(h.v.Item,{children:function(e){var t=e.active;return(0,f.jsx)(P.rU,{to:"/help",className:"".concat(t?"bg-sky-600 text-white":"text-gray-900"," group flex w-full items-center rounded-md px-2 py-2 font-medium text-base capitalize"),children:"help"})}})}),(0,f.jsx)("div",{className:"px-1 py-1 ",children:(0,f.jsx)(h.v.Item,{children:function(e){var t=e.active;return(0,f.jsx)(P.rU,{to:"/settings",className:"".concat(t?"bg-sky-600 text-white":"text-gray-900"," group flex w-full items-center rounded-md px-2 py-2 font-medium text-base capitalize"),children:"settings"})}})}),(0,f.jsx)("div",{className:"px-1 py-1 ",children:(0,f.jsx)(h.v.Item,{children:function(e){var t=e.active;return(0,f.jsx)("button",{type:"button",className:"".concat(t?"bg-sky-600 text-white":"text-gray-900"," group flex w-full items-center rounded-md px-2 py-2 font-medium text-base capitalize"),onClick:u,children:"logout"})}})})]})})]})})},S=function(){var e=(0,x.Z)(),t=e.auth,n=e.setAuth,a=t,i=(0,o.D)({mutationKey:"logout",mutationFn:function(){return d.WY.post("/api/logout").then((function(e){localStorage.removeItem("user"),n(null),u.E.invalidateQueries(["posts"])})).catch((function(e){console.log({error:e}),alert("Logout unsuccessful!")}))},onError:function(e){console.log({err:e}),alert("Logout unsuccessful!")}}).mutate;console.log();var l=function(){var e=(0,r.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,f.jsxs)("div",{children:[a?(0,f.jsx)(I,{menuBtnClasses:"w-full",handleButton:l,children:(0,f.jsxs)("div",{className:"flex justify-between items-center bg-white drop-shadow-lg rounded-lg my-4 p-2",children:[(0,f.jsx)("span",{className:"text-lg font-medium",children:null===a||void 0===a?void 0:a.name}),(0,f.jsx)(g.m1,{customClasses:"w-12 h-12 rounded-full object-cover shadow",src:null===a||void 0===a?void 0:a.profileImage,alt:"Profile avatar"})]})}):(0,f.jsx)("div",{className:"",children:(0,f.jsx)(P.rU,{to:"/auth",className:"text-lg font-medium",children:(0,f.jsxs)("div",{className:"flex justify-center items-center gap-2 bg-white hover:bg-sky-700 hover:text-white drop-shadow-lg rounded-lg my-4 p-2",children:["Sign in",(0,f.jsx)(g.m5,{customClasses:"w-8 h-8"})]})})}),(0,f.jsx)("div",{})]})},T=function(){var e=(0,x.Z)().auth,t=(0,c.useState)({text:"",file:null}),n=(0,l.Z)(t,2),m=n[0],h=n[1],v=(0,o.D)({mutationKey:"publishPost",mutationFn:function(e){return d.WY.post("/api/create/post",e).then((function(e){u.E.invalidateQueries(["posts"])}))},onSuccess:function(){h((function(e){return(0,i.Z)((0,i.Z)({},e),{},{text:"",file:null})}))},onError:function(e){console.log({err:e}),alert("Mutation unsuccessful!")}}).mutate,p=function(){var e=(0,r.Z)((0,s.Z)().mark((function e(){var t,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!m.file){e.next=7;break}return(t=new FormData).append("file",m.file),e.next=5,d.WY.post("/api/upload",t);case 5:return n=e.sent,e.abrupt("return",n);case 7:return e.abrupt("return","");case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=function(){var e=(0,r.Z)((0,s.Z)().mark((function e(){var t,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(m.text.length>0||m.file)){e.next=7;break}return e.next=3,p();case 3:return t=e.sent,n=t?t.data.file:"",e.next=7,v({text:m.text,imageName:n});case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,f.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-[300px_minmax(500px,_1fr)_300px] gap-4 ",children:[(0,f.jsx)("div",{className:"px-5 hidden lg:block",children:(0,f.jsx)(F,{})}),(0,f.jsxs)("div",{className:"px-5",children:[(0,f.jsx)("div",{className:"mb-4",children:(0,f.jsx)("div",{children:(0,f.jsx)("h2",{className:"text-2xl font-medium text-center",children:"News Feed"})})}),e?(0,f.jsx)("div",{className:"",children:(0,f.jsx)(C,{post:m,handlePost:function(e){"file"!==e.target.name?h((function(t){return(0,i.Z)((0,i.Z)({},t),{},(0,a.Z)({},e.target.name,e.target.value))})):h((function(t){return(0,i.Z)((0,i.Z)({},t),{},(0,a.Z)({},e.target.name,e.target.files[0]))}))},handlePostSubmit:g,activeBtn:m.text.length>0||m.file})}):null,(0,f.jsx)("div",{className:"my-3",children:(0,f.jsx)(k,{})})]}),(0,f.jsxs)("div",{className:"px-5 hidden md:block",children:[" ",(0,f.jsx)(S,{})]})]})}}}]);
//# sourceMappingURL=576.114bc6a4.chunk.js.map